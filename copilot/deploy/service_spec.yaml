# ============================================================================
# TERRA Geospatial Analytics - Snowpark Container Services Specification
# ============================================================================
# Deploy to SPCS using:
#   CREATE SERVICE CONSTRUCTION_GEO_DB.SPCS.TERRA_SERVICE
#   IN COMPUTE POOL TERRA_COMPUTE_POOL
#   FROM SPECIFICATION_FILE = '@<stage>/service_spec.yaml';

spec:
  containers:
    - name: terra
      image: /construction_geo_db/spcs/terra_images/terra:latest
      env:
        SNOWFLAKE_DATABASE: CONSTRUCTION_GEO_DB
        SNOWFLAKE_SCHEMA: CONSTRUCTION_GEO
        SNOWFLAKE_WAREHOUSE: CONSTRUCTION_WH
        LOG_LEVEL: INFO
      resources:
        requests:
          memory: 2Gi
          cpu: 1
        limits:
          memory: 4Gi
          cpu: 2
      readinessProbe:
        port: 8080
        path: /health
      volumeMounts:
        - name: logs
          mountPath: /var/log
  endpoints:
    - name: terra-endpoint
      port: 8080
      public: true
  volumes:
    - name: logs
      source: local
